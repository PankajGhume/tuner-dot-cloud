!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var r=n(6),o=i(r),s=n(2),a=n(5),c=i(a),u=n(7),l=i(u);if(n(9),navigator.serviceWorker){var f=window.location;/^http:.*github\.io/.test(f.href)&&f.replace(f.href.replace(/^http/,"https")),navigator.serviceWorker.register("./offline-worker.js").then(function(){console.log("Offlined! Continue to tune offline anytime â€¦")})["catch"](function(e){console.error("Offlining failed",e)})}var h=4096,d=2048,p=!1,v=new l["default"],g=c["default"].get("piano"),m=new o["default"]({bufferSize:h,fftSize:d,range:g.pitchRange});m.ready.then(function(){document.body.classList.remove("is-prompting"),document.body.classList.add("is-silent"),console.log("Web Audio is on the air!")},function(e){document.body.classList.remove("is-prompting"),e.message.contains("not implemented")&&document.body.classList.remove("is-not-supported"),console.error("Web Audio setup failed!",e)}),document.body.classList.remove("is-loading"),document.body.classList.add("is-prompting"),m.on("didSkip",function(){v.set("detected",!1)}),m.on("didDetect",function(e){var t=e.pitch;p||(p=!0,document.body.classList.remove("is-silent"));var n=(0,s.noteFromPitch)(t);v.set("detected",!0),v.set("last",Date.now()),v.set("pitch",t),v.set("note",n),v.set("cents",n.centsOffFromPitch(t))}),v.start()},function(e,t,n){var i;(function(){"use strict";function t(){}function r(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function o(e){return function(){return this[e].apply(this,arguments)}}var s=t.prototype,a=this,c=a.EventEmitter;s.getListeners=function(e){var t,n,i=this._getEvents();if(e instanceof RegExp){t={};for(n in i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n])}else t=i[e]||(i[e]=[]);return t},s.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},s.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},s.addListener=function(e,t){var n,i=this.getListenersAsObject(e),o="object"==typeof t;for(n in i)i.hasOwnProperty(n)&&-1===r(i[n],t)&&i[n].push(o?t:{listener:t,once:!1});return this},s.on=o("addListener"),s.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},s.once=o("addOnceListener"),s.defineEvent=function(e){return this.getListeners(e),this},s.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},s.removeListener=function(e,t){var n,i,o=this.getListenersAsObject(e);for(i in o)o.hasOwnProperty(i)&&(n=r(o[i],t),-1!==n&&o[i].splice(n,1));return this},s.off=o("removeListener"),s.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},s.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},s.manipulateListeners=function(e,t,n){var i,r,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)o.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&("function"==typeof r?o.call(this,i,r):s.call(this,i,r));return this},s.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if(e instanceof RegExp)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},s.removeAllListeners=o("removeEvent"),s.emitEvent=function(e,t){var n,i,r,o,s,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].slice(0),r=n.length;r--;)i=n[r],i.once===!0&&this.removeListener(e,i.listener),s=i.listener.apply(this,t||[]),s===this._getOnceReturnValue()&&this.removeListener(e,i.listener);return this},s.trigger=o("emitEvent"),s.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},s.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},s._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},s._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return a.EventEmitter=c,t},i=function(){return t}.call(a,n,a,e),!(void 0!==i&&(e.exports=i))}).call(this)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return 12*(Math.log(e/440)/Math.log(2))+49}function r(e){return Math.round(i(e))}function o(e){return l.get(r(e))||null}function s(e){return 440*Math.pow(2,(e-49)/12)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.centFromPitch=i,t.indexFromPitch=r,t.noteFromPitch=o,t.pitchFromIndex=s;for(var c=function(){function e(t,i){n(this,e),this.note=t,this.octave=i,this.index=12*i+t+1,this.pitch=s(this.index);var r=u[t];this.notation=r,this.whole=r.charAt(0),this.accidental=r.charAt(1)||"";var o=l.get(this.index-1);o&&(this.previous=o,o.next=this)}return e.prototype.toString=function(){return this.notation},e.prototype.centsOffFromPitch=function(e){return 1200*Math.log(e/this.pitch)/Math.log(2)},a(e,[{key:"base",get:function(){return l.get(this.index%12)||this}}]),e}(),u=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],l=t.byIndex=new Map,f=t.byName=new Map,h=t.list=new Set,d=0;8>=d;d++)for(var p=0;12>p;p++){var v=new c(p,d);l.set(v.index,v),f.set(v.notation+v.octave,v),h.add(v)}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t["default"]=void 0;var a=n(1),c=i(a),u=function(e){function t(){var n=arguments.length<=0||void 0===arguments[0]?null:arguments[0];r(this,t);var i=o(this,e.call(this));return i.fill=n,i.element=document.createElement("canvas"),document.body.appendChild(i.element),i.ctx=i.element.getContext("2d"),window.addEventListener("resize",function(){return i.fit()}),i.fit(),i}return s(t,e),t.prototype.clear=function(){this.ctx.save(),this.fill?(this.ctx.fillStyle=this.fill,this.ctx.fillRect(0,0,this.size[0],this.size[1])):this.ctx.clearRect(0,0,this.size[0],this.size[1]),this.ctx.restore()},t.prototype.fit=function(){this.ctx.restore(),this.size=[window.innerWidth,window.innerHeight];var e=this.element,t=this.size,n=window.devicePixelRatio||1,i="scale("+1/n+")";e.style.transform=i,e.width=t[0]*n,e.height=t[1]*n,this.ctx.scale(n,n),this.ctx.save()},t}(c["default"]);t["default"]=u},function(e,t){"use strict";t.__esModule=!0,t["default"]={piano:["A0","C8"],voice:["F2","C6"],guitar:["D2","G4"],bass:["B0","G2"],ukuleleSoprano:["C4","A4"]}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=n(2),s=n(4),a=i(s),c=function f(e,t){r(this,f),this.name=e,this.notes=t;var n=o.byName.get(t[0]),i=o.byName.get(t[1]);this.pitchRange=[(n.previous||n).pitch,(i.next||i).pitch]},u=new Map;for(var l in a["default"])u.set(l,new c(l,a["default"][l]));t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,n(10);var a=n(1),c=i(a),u=n(11),l=i(u),f=window.AudioContext||window.webkitAudioContext,h=function(e){function t(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];r(this,t);var i=o(this,e.call(this));return i.input=null,i.source=null,i.peak=0,i.pitch=0,i.bufferSize=2048,i.threshold=.05,i.range=null,i.detecting=!1,i.started=!1,i.passthrough=!1,i.peak=0,i.ready=new Promise(function(e,t){i.resolveReady=e,i.rejectReady=t}),Object.assign(i,n),i.context||(i.context=new f),i.sampleRate=i.context.sampleRate,i.channelData=new Float32Array(i.bufferSize),i.script=i.context.createScriptProcessor(i.bufferSize,1,1),i.script.onaudioprocess=function(e){i.detect(e)},i.script.connect(i.context.destination),i.worker=new l["default"],i.worker.postMessage({type:"init",bufferSize:i.bufferSize,sampleRate:i.sampleRate}),i.worker.addEventListener("message",function(e){i.didDetect(e.data)}),document.addEventListener("visibilitychange",function(){document.hidden&&i.stop(),i.start()}),i.start(),i}return s(t,e),t.prototype.detect=function(e){var t=e.inputBuffer,n=e.outputBuffer;if(!this.detecting){this.detecting=!0;for(var i=this.passthrough,r=this.channelData,o=t.getChannelData(0),s=i?n.getChannelData(0):null,a=Math.max.apply(Math,o),c=0;c<this.bufferSize;c++)r[c]=o[c]/a,i&&(s[c]=o[c]);this.peak=a,this.worker.postMessage({type:"detect",channelData:r.buffer},[r.buffer])}},t.prototype.didDetect=function(e){var t=e.pitch,n=e.channelData;return this.detecting=!1,this.channelData=new Float32Array(n),this.range[0]>t||this.range[1]<t?void this.emit("didSkip"):void this.emit("didDetect",{pitch:t})},t.prototype.start=function(){var e=this;return this.started?Promise.resolve():(this.started=!0,this.input&&!this.input.enabled?Promise.resolve():navigator.mediaDevices.getUserMedia({audio:!0}).then(function(t){var n=t.getAudioTracks()[0];e.input=n,e.input.addEventListener("ended",function(){return e.end(!0)}),e.source=e.context.createMediaStreamSource(t),e.source.connect(e.script),e.emit("source",e.source),e.resolveReady()})["catch"](function(t){e.started=!1,console.log(t),e.rejectReady(t.message)}))},t.prototype.stop=function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];this.started&&(this.started=!1,e&&(this.input=null,this.source.disconnect(),this.source=null),this.on("didDisconnect"))},t}(c["default"]);t["default"]=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t["default"]=void 0;var a=n(1),c=i(a),u=n(3),l=i(u),f=n(8),h=function(e){function t(){var n,i,s;r(this,t);for(var a=arguments.length,c=Array(a),u=0;a>u;u++)c[u]=arguments[u];return n=i=o(this,e.call.apply(e,[this].concat(c))),i.main=new l["default"]("rgb(30, 68, 136)"),i.graph=new l["default"],i.updateBound=i.update.bind(i),i.centsSpring=new f.Spring(0),i.volumeSpring=new f.Spring(0),i.detectedSpring=new f.Spring(0),i.last=0,i.cents=0,i.volume=0,i.pitch=0,i.note=null,i.detected=!1,i.lastNote=!1,s=n,o(i,s)}return s(t,e),t.prototype.set=function(e,t){var n=this[e];this[e]=t,this.emit(e,t,n)},t.prototype.start=function(){this.update(window.performance.now())},t.prototype.update=function(e){var t=this.note&&this.lastNote!==this.note.whole;window.requestAnimationFrame(this.updateBound),this.volumeSpring.setEndValue(this.volume),this.centsSpring.setEndValue(this.cents,t),this.detectedSpring.setEndValue(this.detected?1:0,t),(0,f.tickSpring)(e);var n=this.main,i=n.ctx,r=n.size,o=[r[0]/2,r[1]/2];this.main.clear();var s=this.centsSpring.value/50,a=.7*this.detectedSpring.value+.3,c=.38*o[0],u=s*c;i.save(),i.fillStyle="rgba(111, 190, 74, "+a+")",i.fillRect(o[0]+o[0]*s-u/2,0,u,r[1]),i.restore();var l=this.note,h=Math.round(.61*o[1]),d=Math.round(.61*h);i.save(),i.textAlign="right",i.textBaseline="middle",i.font=h+"px sans-serif",i.fillStyle="rgba(255, 255, 255, "+a+")",l&&(i.fillText(l.whole,o[0],o[1]),i.textAlign="left",i.font=d+"px sans-serif",i.textBaseline="top",i.fillText(l.octave,o[0]+.38*d,o[1]-.61*h),i.textBaseline="bottom",i.fillText(l.accidental,o[0]+.38*d,o[1]+.61*h)),i.restore(),this.emit("didUpdate"),this.note&&this.detected&&(this.lastNote=this.note.whole)},t}(c["default"]);t["default"]=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){if(e/=1e3,0===w)return w=e,!0;y+=Math.min(e-w,.5),w=e;var t=Math.floor(y/g);if(y-=t*g,0===t||0===v)return!1;for(var n=0,i=p.length;i>n;n++){var r=p[n];if(r.active)for(var o=0;t>o;o++){var s=r.tension*(r.endValue-r.value);if(r.value+=(r.velocity+.5*s*g)*g,r.velocity=(r.velocity+.5*(s+r.tension*(r.endValue-r.value))*g)*r.damping,Math.abs(r.value-r.endValue)<m&&Math.abs(r.velocity)<m){r.active=!1,v--;break}}}return!0}function c(e,t){for(var n=[],i=0,r=e.length;r>i;i++)n.push(new d(e[i],t));return n}function u(e,t){for(var n=0,i=e.length;i>n;n++)e[n].setEndValue(t[n])}function l(e,t){for(var n=0,i=e.length;i>n;n++)t(e[n].value,e[n].ref)}t.__esModule=!0,t.Spring=void 0,t.tickSpring=a,t.createSprings=c,t.setSprings=u,t.forEachSpring=l;var f=n(1),h=i(f),d=t.Spring=function(e){function t(){var n=arguments.length<=0||void 0===arguments[0]?0:arguments[0],i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,t);var s=o(this,e.call(this));return s.velocity=0,s.tension=50,s.damping=.85,s.active=!0,s.ref=null,s.endValue=n,s.value=n,Object.assign(s,i),v++,p.push(s),s}return s(t,e),t.prototype.setEndValue=function(e,t){this.endValue===e&&this.value===e||(this.endValue=e,t?(this.velocity=0,this.value=e):this.active||(this.active=!0,v++))},t}(h["default"]),p=[],v=0,g=1/60,m=.01,y=0,w=0},function(e,t){},function(e,t){!function(){var e=function(e,t,n){var i=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return i?new Promise(function(t,n){i.call(navigator,e,t,n)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))};void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=e)}()},function(e,t,n){e.exports=function(){return new Worker(n.p+"pitchfinder-worker.015d5c5f89d8dbb1ef7c.js")}}]);